# Ubuntu
## Allgemeine Befehle
Hilfe zu Befehl
```bash
man "ifconfig"
```

 Verzeichnisse mit Berechtigungen anzeigen
```bash
ls -l
```

Speicher/Partitionen anzeigen
```bash
df -h
```

 Dienste anzeigen
```bash
systemctl list-units --type=service
```


Ordner erstellen
```bash
mkdir <dir name> -p
```

Kopieren
```bash
cp <source> <dest>
```

## User
Benutzer erstellen
```bash
adduser <username>
```

Benutzer erstellen (Oneliner)
```bash
useradd <username> -p <pw> -d <home dir> -s <shell path> -c '<fullname>' -m
```

Passwort ändern
```bash
passwd <username>
```

Home ändern
```bash
usermod -d <home dir> <username>
```

Shell ändern
```bash
usermod -s <shell path> <username>
```

User mit Gruppe anzeigen
```bash
id <username>
```

## Group
Gruppe erstellen
```bash
groupadd <group name>
```

User hinzufügen
```bash
usermod -a -G <group name> <username>
```

 Primäre Gruppe bearbeiten
```bash
usermod -g <group name> <username>
```

 [Gruppen anzeigen](https://www.cyberciti.biz/faq/understanding-etcgroup-file/)
```bash
nano /etc/group
```

## Berechtigungen

 Inhaber wechseln
```bash
chown <username> <file>
```

## Rechte für Kommandos
Command finden
```bash
whereis <command>
```

Berechtigungen setzen
```bash
usermod -g <group name> <username>
```

Beispiele
```
Root	ALL=(ALL:ALL) ALL
admin	ALL=NOPASSWD: ALL
max		ALL=NOPASSWD: /usr/lib/openssh/sftp-server
```

## Festplatten

Festplatten neu scannen
```bash
apt-get install scsitools
rescan-scsi-bus
```
Medien auflisten
```bash
ls -l /dev
# Oder
lsblk
```
Command 
```bash
fdisk /dev/<disk>
> g # neue Partitionstabelle
> n # neue Partition
> p # Partitionen ausgeben
> w # Änderungen speichern

mkfs.ext4 /dev/<partition (sdb1)> # ext4 Filesystem erstellen
```
Mounten
```bash
nano /etc/fstab
> /dev/<disk> /mnt/<mount-dir> ext4

mount -a
```
Archiv erstellen
```bash
tar -czvf <dest> <source>
```

## APT
Updates
```bash
apt-get update
apt-get upgrade
```

##  Webmin
[Installation](https://www.digitalocean.com/community/tutorials/how-to-install-webmin-on-ubuntu-20-04)
```bash
apt-get update
nano /etc/apt/sources.list
> deb http://download.webmin.com/download/repository sarge contrib

wget -q -O- http://www.webmin.com/jcameron-key.asc | sudo apt-key add
apt-get update
apt-get install webmin -y
```

Config
```bash
nano /etc/webmin/miniserv.conf
service webmin restart
```

## [SSH](https://wiki.ubuntuusers.de/SSH/)
Root Zugriff deaktivieren
```bash
nano /etc/ssh/sshd_config
> PermitRootLogin no
```

Zugriff für User
```bash
nano /etc/ssh/sshd_config
> AllowUsers <user1> <user2>
service ssh restart
```

Zugriff für Gruppe
```bash
nano /etc/ssh/sshd_config
> AllowGroups <group1> <group2>
service ssh restart
```

Key
```bash
nano /root/.ssh/authorized_keys
> <public-key>
```

## Fail2Ban
Installation
```bash
apt-get install fail2ban -y
```

Config
```bash
nano /etc/fail2ban/fail2ban.d/ssh.conf
```
```ini
[ssh]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 1h
```

Status anzeigen
```bash
fail2ban-client status
```

Ban IP Adress
```bash
fail2ban-client set <Jail> banip <IP Address>
```

Unban IP Address
```bash
fail2ban-client set <Jail> unbanip <IP Address>
```

Whitelist IP Adress
```bash
fail2ban-client set <jail> addignoreip <IP Address>
```

## IP-Einstellungen
[Conf Datei](https://websiteforstudents.com/configuring-static-ips-ubuntu-17-10-servers/)
```bash
nano /etc/netplan/00-installer-config.yaml
```
```yaml
addresses: [192.168.1.2/24]
gateway4: 192.168.1.1
nameservers:
	addresses: [8.8.8.8,8.8.4.4]
	dhcp4: no
```
```bash
netplan apply
```

## Script

Angemeldete User ausgeben
```bash
w
```

Datum ausgeben
```bash
date +"Heute ist der %d.%B %Y, %H:%M:%S"
```

Speicherkapazität der eingebundenen Datenträger ausgeben
```bash
lsblk | grep -E "disk|part"
```

Aktuelle Prozesstabelle von allen Benutzern und Diensten
```bash
ps -e
# Oder
top -bn1
```

Aktive Netzwerkverbindungen mit den dazugehörigen Ports
```bash
netstat -tulpen
```

Shell-Variable
```bash
name="Justin Iven Müller"
echo $name
```

Fehler umleiten
```bash
exec >> /opt/erfolg.log
exec 2>> /opt/error.log
```

## Web-Server

### [Apache](https://www.digitalocean.com/community/tutorials/how-to-install-the-apache-web-server-on-ubuntu-20-04)

Installation  
```bash  
apt-get install apache2 -y
```

Seiten erstellen  
```bash  
mkdir /var/www/<domain>
echo "<html><head><title>test</title></head><body><h1>test</h1></head></html>" > /var/www/<domain>/index.html  
chown www-data:www-data -R /var/www/*  
```  
Config erstellen  
```bash  
nano /etc/apache2/sites-available/<domain>.conf  
```  
```xml  
<VirtualHost *:80>  
ServerAdmin webmaster@<domain>  
ServerName <domain>  
DocumentRoot /var/www/<domain>  
ErrorLog ${APACHE_LOG_DIR}/error.log  
CustomLog ${APACHE_LOG_DIR}/access.log combined  
</VirtualHost>  
```  
Seite hinzufügen und neu starten  
```bash  
a2ensite <domain>  
systemctl restart apache2  
```  
Eintrag in Hostdatei C:\Windows\System32\drivers\etc\host  
```  
<serverip> <domain>  
```

  
### [MySQL](https://www.digitalocean.com/community/tutorials/how-to-install-linux-apache-mysql-php-lamp-stack-ubuntu-18-04-de)

Installation  
```bash  
apt-get install mysql-server -y  
```  
```bash  
mysql_secure_installation  
```  
Testen  
```bash  
mysql  
```  
```sql  
SELECT user,authentication_string,plugin,host FROM mysql.user;  
```  
## PHP

Installieren  
```bash  
apt-get install php libapache2-mod-php php-mysql -y  
```  
2. index.php bevorzugen  
```bash  
nano /etc/apache2/mods-enabled/dir.conf  
```  
```xml  
<IfModule mod_dir.c>  
DirectoryIndex index.php index.html index.cgi index.pl index.xhtml index.htm  
</IfModule>  
```  
3. Neustarten  
```  
systemctl restart apache2  
```  
## [phpMyAdmin](https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-phpmyadmin-on-ubuntu-20-04)

1. Installieren  
```bash  
apt-get install phpMyAdmin  
```  
2. Root login erlauben

mysql  
```sql  
ALTER USER 'root'@'localhost' IDENTIFIED WITH caching_sha2_password BY 'password';  
SELECT user,authentication_string,plugin,host FROM mysql.user;  
```